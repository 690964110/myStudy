<<<<<<< HEAD
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        .tpl {
            display: none;
        }

        .wrapper {
            overflow: hidden;
            border: 2px solid black;
            width: 600px;
            margin: 100px auto 0px;
        }

        .movieSection {
            float: left;
            width: 180px;
            height: 180px;
            padding: 10px;
        }

        .movieSection img {
            width: 100%;
            height: 150px;
            cursor: pointer;
        }

        .movieSection h3 {
            height: 30px;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="tpl">
            <img src="" alt="">
            <h3 class="movieName"></h3>
        </div>
    </div>
</body>
<script src="../../js/jquery.js"></script>
<script>
    //.then(function(){},functio(){})
    //第一个函数代表成功，第二个函数代表失败

    // $.ajax({
    //     url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/power',
    //     type: 'post',
    //     data: {
    //         username: 'cst',
    //         password: '123123'
    //     },
    //     success: function (res) {

    //         if (res.data.power == 'root') {
    //             //vip 网络发送请求
    //             $.ajax({
    //                 url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieList',
    //                 type: 'get',
    //                 success: function (res) {
    //                     var data = res.data;
    //                     var $wrapper = $('.wrapper');
    //                     $.each(data, function (index, ele) {
    //                         var $Clone = $('.tpl').clone().removeClass('tpl').addClass('movieSection');
    //                         $Clone.data({ id: ele.id }).on('click', function () {
    //                             $.ajax({
    //                                 url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieInfo',
    //                                 type: 'get',
    //                                 data: {
    //                                     movieId: $(this).data('id')
    //                                 },
    //                                 success: function (res) {
    //                                     var data = res.data;
    //                                     var direct = data.direct;
    //                                     var gut = data.gut;
    //                                     var mainActor = data.mainActor;
    //                                     var screenWriter = data.screenwriter;
    //                                     var htmlStr = '<div class="mask">\
    //                                     <p>导演： ' + direct + '</p>\
    //                                     <p>剧情： ' + gut + '</p>\
    //                                     <p>主演： ' + mainActor.reduce(function (prev, curv) {
    //                                         prev += curv + ' ';
    //                                     }, '') + '</p>\
    //                                     <p>编剧： ' + screenWriter.reduce(function (prev, curv) {
    //                                         prev += curv + ' ';
    //                                     }, '') + '</p>\
    //                                     </div>'
    //                                     $(htmlStr).appendTo('body').css({ position: 'absolute', left: $(window).outerWidth() / 2, bottom: 100, width: '400px', marginLeft: -200 })
    //                                 }
    //                             })
    //                         }).children().eq(0).attr('src', ele.poster)
    //                             .next().text(ele.name);
    //                         $wrapper.append($Clone);
    //                     })

    //                 }
    //             })
    //         } else {

    //         }
    //     }
    // })
        //先是立即执行函数。让函数执行
        (function () {
            return $.ajax({
                url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/power',
                type: 'post',
                data: {
                    username: 'cst',
                    password: '123123'
                }
            });
        })().then(function (res) {
            if (res.data.power == 'root') {
                return $.ajax({
                    url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieList',
                    type: 'get'
                });

            } else {
                //失败是做的事情
            }
        }).then(function (res) {
            var data = res.data;
            var $wrapper = $('.wrapper');
            var df = $.Deferred();
            $.each(data, function (index, ele) {
                var $Clone = $('.tpl').clone().removeClass('tpl').addClass('movieSection');
                $Clone.data({ id: ele.id }).on('click', function () {
                    df.resolve();
                }).children().eq(0).attr('src', ele.poster)
                    .next().text(ele.name);
                $wrapper.append($Clone);
            });
            return df.promise();
        }).then(function () {
            return $.ajax({
                url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieInfo',
                type: 'get',
                data: {
                    movieId: $(this).data('id')
                }
            })
        }).then(function (res) {
            var data = res.data;
            var direct = data.direct;
            var gut = data.gut;
            var mainActor = data.mainActor;
            var screenWriter = data.screenwriter;
            var htmlStr = '<div class="mask">\
                <p>导演： ' + direct + '</p>\
                <p>剧情： ' + gut + '</p>\
                <p>主演： ' + mainActor.reduce(function(prev, curv){
                     prev += curv + ' ';
                     return prev;
                },'') + '</p>\
                <p>编剧： ' + screenWriter.reduce(function(prev, curv){
                     prev += curv + ' ';
                    return prev;
                },'') + '</p>\
                </div>'
            $(htmlStr).appendTo('body').css({ position: 'absolute', left: $(window).outerWidth() / 2, bottom: 100, width: '400px', marginLeft: -200 })
        })

</script>

=======
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        .tpl {
            display: none;
        }

        .wrapper {
            overflow: hidden;
            border: 2px solid black;
            width: 600px;
            margin: 100px auto 0px;
        }

        .movieSection {
            float: left;
            width: 180px;
            height: 180px;
            padding: 10px;
        }

        .movieSection img {
            width: 100%;
            height: 150px;
            cursor: pointer;
        }

        .movieSection h3 {
            height: 30px;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="tpl">
            <img src="" alt="">
            <h3 class="movieName"></h3>
        </div>
    </div>
</body>
<script src="../../js/jquery.js"></script>
<script>
    //.then(function(){},functio(){})
    //第一个函数代表成功，第二个函数代表失败

    // $.ajax({
    //     url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/power',
    //     type: 'post',
    //     data: {
    //         username: 'cst',
    //         password: '123123'
    //     },
    //     success: function (res) {

    //         if (res.data.power == 'root') {
    //             //vip 网络发送请求
    //             $.ajax({
    //                 url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieList',
    //                 type: 'get',
    //                 success: function (res) {
    //                     var data = res.data;
    //                     var $wrapper = $('.wrapper');
    //                     $.each(data, function (index, ele) {
    //                         var $Clone = $('.tpl').clone().removeClass('tpl').addClass('movieSection');
    //                         $Clone.data({ id: ele.id }).on('click', function () {
    //                             $.ajax({
    //                                 url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieInfo',
    //                                 type: 'get',
    //                                 data: {
    //                                     movieId: $(this).data('id')
    //                                 },
    //                                 success: function (res) {
    //                                     var data = res.data;
    //                                     var direct = data.direct;
    //                                     var gut = data.gut;
    //                                     var mainActor = data.mainActor;
    //                                     var screenWriter = data.screenwriter;
    //                                     var htmlStr = '<div class="mask">\
    //                                     <p>导演： ' + direct + '</p>\
    //                                     <p>剧情： ' + gut + '</p>\
    //                                     <p>主演： ' + mainActor.reduce(function (prev, curv) {
    //                                         prev += curv + ' ';
    //                                     }, '') + '</p>\
    //                                     <p>编剧： ' + screenWriter.reduce(function (prev, curv) {
    //                                         prev += curv + ' ';
    //                                     }, '') + '</p>\
    //                                     </div>'
    //                                     $(htmlStr).appendTo('body').css({ position: 'absolute', left: $(window).outerWidth() / 2, bottom: 100, width: '400px', marginLeft: -200 })
    //                                 }
    //                             })
    //                         }).children().eq(0).attr('src', ele.poster)
    //                             .next().text(ele.name);
    //                         $wrapper.append($Clone);
    //                     })

    //                 }
    //             })
    //         } else {

    //         }
    //     }
    // })
        //先是立即执行函数。让函数执行
        (function () {
            return $.ajax({
                url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/power',
                type: 'post',
                data: {
                    username: 'cst',
                    password: '123123'
                }
            });
        })().then(function (res) {
            if (res.data.power == 'root') {
                return $.ajax({
                    url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieList',
                    type: 'get'
                });

            } else {
                //失败是做的事情
            }
        }).then(function (res) {
            var data = res.data;
            var $wrapper = $('.wrapper');
            var df = $.Deferred();
            $.each(data, function (index, ele) {
                var $Clone = $('.tpl').clone().removeClass('tpl').addClass('movieSection');
                $Clone.data({ id: ele.id }).on('click', function () {
                    df.resolve();
                }).children().eq(0).attr('src', ele.poster)
                    .next().text(ele.name);
                $wrapper.append($Clone);
            });
            return df.promise();
        }).then(function () {
            return $.ajax({
                url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieInfo',
                type: 'get',
                data: {
                    movieId: $(this).data('id')
                }
            })
        }).then(function (res) {
            var data = res.data;
            var direct = data.direct;
            var gut = data.gut;
            var mainActor = data.mainActor;
            var screenWriter = data.screenwriter;
            var htmlStr = '<div class="mask">\
                <p>导演： ' + direct + '</p>\
                <p>剧情： ' + gut + '</p>\
                <p>主演： ' + mainActor.reduce(function(prev, curv){
                     prev += curv + ' ';
                     return prev;
                },'') + '</p>\
                <p>编剧： ' + screenWriter.reduce(function(prev, curv){
                     prev += curv + ' ';
                    return prev;
                },'') + '</p>\
                </div>'
            $(htmlStr).appendTo('body').css({ position: 'absolute', left: $(window).outerWidth() / 2, bottom: 100, width: '400px', marginLeft: -200 })
        })

</script>

>>>>>>> 2c31271da4abb59f594c272f997dfa72a631001a
</html>